<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Event Chat</title>
    <link rel="stylesheet" href="{{ static_url("chat.css") }}" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script type='text/javascript' src='https://s3.amazonaws.com/mturk-public/externalHIT_v1.js'></script>
  </head>
  <body>
    <div class="container">
      <div class="row shadow mt-4">
        <div class="badge" style="background-color: rgb(213, 248, 145);">
            <p class="fs-3" style="color: black;">Room {{room_client_info['room_id']}} matched: Worker {{room_client_info['speaker_1']}} and Worker {{room_client_info['speaker_2']}}</p> 
        </div>
      </div>
    
      <div class="row mt-4">
        <div class="col-4">
            <p>
                Here goes the instruciton.
            </p>
            <label for="report">
                Any offensive, abusive, toxic, harmful behaviors during the conversation is not allowed.
                If your matched partner spoke something offensive,
                you can click this button to report. The more details you could provide,
                the quicker we could handle your report.
            </label>
            <textarea id="report_message" name="report message" placeholder="Describe the offensive behaviors here..."></textarea>
            <input type="button" name="report" id="report" value="Send your report"/>
        </div>
      
        <div class="col-8 align-self-end">
          <div class="row" id="body">
            <div id="room_info">
              <input type="hidden" id="workerId" value="{{room_client_info['worker_id']}}"/>
              <input type="hidden" id="roomId" value="{{room_client_info['room_id']}}"/>
            </div>
            
            <div class="row">
              <div class="overflow-auto" style="height: 800px; background-color: bisque;" id="inbox_container">
                <div class="col-9 align-self-end list-group d-inline-block" id="inbox">

                </div>
              </div>
            </div>

            <div class="row" id="input">
              <table>
                <tr>
                  <td><label>Your ID: {{room_client_info['worker_id']}}</label></td>
                </tr>
                <tr>
                  <div id="events">
                    Gap: {{room_client_info['gap_info']}} <br>
                    Events: {{room_client_info['events_info']}}
                  </div>
                </tr>
                <tr>
                  <td><textarea name="body" id="message" style="width: 400px;"></textarea></td>
                  <td style="padding-left: 20px;">
                    <input class="btn btn-primary" type="button" value="Post" id="new_message">
                    <input type="hidden" name="next" value="{{ request.path }}?workerId={{room_client_info['worker_id']}}">
                    {% module xsrf_form_html() %}
                  </td>
                  <td style="padding-left: 20px;">
                    <input type="button" class="btn btn-primary" value="New Session" id="new_session"/>
                    <input type="hidden" name="nextSession" value="{{ request.path }}?workerId={{room_client_info['worker_id']}}" data-toggle="modal" data-target="#time_machine"/>
                  </td>
                </tr>
              </table>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="time_machine" tabindex="-1" role="dialog" aria-labelledby="timeMachine">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <!-- modal header -->
                  <div class="modal-header">
                    Riding on the Time Machine!
                  </div>

                  <!-- modal body -->
                  <div class="modal-body">

                  </div>

                  <!-- modal footer -->
                  <div class="modal-footer">

                  </div>

                </div>
              </div>
            </div>
            <!-- Modal -->

          </div>
        </div>
      </div>

      <div id="mturk">
        <form name='mturk_form' method='post' id='mturk_form' action='https://workersandbox.mturk.com/mturk/externalSubmit'>
          <p><input type="hidden" id="assignmentId" value="" name="assignmentId"/></p>
          <div>
            <input type="checkbox" id="submitCheck" name="submitCheck"/>
            <label for="submitCheck">I have finished the HIT and I'm ready to submit.</label>
          </div>
          <p><input type="submit" id="hit_submit" value="Finish the HIT and Go Back to AMT"/> </p>
        </form>
      </div>
      <script language='Javascript'>turkSetAssignmentID();</script>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js" type="text/javascript"></script>
    <!-- <script src="{{ static_url("chat.js") }}" type="text/javascript"></script> -->
    <script src="{{ static_url("websocket.js") }}" type="text/javascript"></script>
  </body>
</html>